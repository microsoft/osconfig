# Copyright (c) Microsoft Corporation. All rights reserved.
$schema: https://aka.ms/osc/schemas/prerelease/document.json
resources:
- name: Access Credential Manager as a trusted caller
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/AccessCredentialManagerAsTrustedCaller
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Access this computer from the network
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/AccessFromNetwork
        type: string
        value: '*S-1-5-32-544,*S-1-5-11'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-11'
- name: Account lockout policy
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/AccountLockoutPolicy
        type: string
        value: AccountLockoutDuration:15, AccountLockoutThreshold:3, ResetAccountLockoutCounterAfter:15
    schema:
      allOf:
      - pattern: ResetAccountLockoutCounterAfter:[1][5-9]|[2-9]\d|[1-9]\d{2,}
      - pattern: AccountLockoutDuration:[1][5-9]|[2-9]\d|[1-9]\d{2,}
      - pattern: AccountLockoutThreshold:[1-3]
- name: 'Accounts: Guest account status'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Accounts_EnableGuestAccountStatus
        type: integer
        value: 0
    schema:
      const: 0
- name: 'Accounts: Limit local account use of blank passwords to console logon only'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Accounts_LimitLocalAccountUseOfBlankPasswordsToConsoleLogonOnly
        type: integer
        value: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: 'Accounts: Rename administrator account'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount
        type: string
        value:
    schema:
      not:
        const: Administrator
- name: 'Accounts: Rename guest account'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Accounts_RenameGuestAccount
        type: string
        value:
    schema:
      not:
        const: Guest
- name: Act as part of the operating system
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ActAsPartOfTheOperatingSystem
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Adjust memory quotas for a process
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/AdjustMemoryQuotasForProcess
        type: string
        value: '*S-1-5-32-544,*S-1-5-19,*S-1-5-20'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-19'
        - '*S-1-5-20'
- name: Allow Custom SSPs and APs to be loaded into LSASS
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: AllowCustomSSPsAPs
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Allow Diagnostic Data
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection
        value: AllowTelemetry
        type: REG_DWORD
        data: 1
    schema:
      minimum: 0
      maximum: 1
- name: Allow indexing of encrypted files
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Windows Search
        value: AllowIndexingEncryptedStoresOrItems
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Allow Input Personalization
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Privacy/AllowInputPersonalization
        type: integer
        value: 0
    schema:
      const: 0
- name: Allow log on locally
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/AllowLocalLogOn
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
- name: Allow log on through Remote Desktop Services
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/AllowLogOnThroughRemoteDesktop
        type: string
        value: '*S-1-5-32-544,*S-1-5-32-555'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-32-555'
- name: Allow Microsoft accounts to be optional
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: MSAOptional
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Allow remote server management through WinRM
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
        value: AllowAutoConfig
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Allow remote server management through WinRM-IPv4Filter
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
        value: IPv4Filter
        type: REG_SZ
        data: '*'
    schema:
      const: '*'
- name: Allow remote server management through WinRM-IPv6Filter
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
        value: IPv6Filter
        type: REG_SZ
        data: '*'
    schema:
      const: '*'
- name: Allow user control over installs
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/ApplicationManagement/MSIAllowUserControlOverInstall
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Always install with elevated privileges
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/ApplicationManagement/MSIAlwaysInstallWithElevatedPrivileges
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Always prompt for password upon connection
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: fPromptForPassword
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Application Identity
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\AppIDSvc
        value: Start
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: 'Application: Control Event Log behavior when the log file reaches its maximum size'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application
        value: Retention
        type: REG_SZ
        data: "0"
    schema:
      oneOf:
      - const: "0"
      - const:
- name: 'Application: Specify the maximum log file size (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application
        value: MaxSize
        type: REG_DWORD
        data: 32768
    schema:
      minimum: 32768
- name: Apply UAC restrictions to local accounts on network logons
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: LocalAccountTokenFilterPolicy
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Audit Account Lockout
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogonLogoff_AuditAccountLockout
        type: integer
        value: 2
    schema:
      enum:
      - 2
      - 3
- name: Audit Authentication Policy Change
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/PolicyChange_AuditAuthenticationPolicyChange
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit Authorization Policy Change
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/PolicyChange_AuditAuthorizationPolicyChange
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit client does not support encryption
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation
        value: AuditClientDoesNotSupportEncryption
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Audit client does not support signing
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation
        value: AuditClientDoesNotSupportSigning
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Audit Credential Validation
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogon_AuditCredentialValidation
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Detailed File Share
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/ObjectAccess_AuditDetailedFileShare
        type: integer
        value: 2
    schema:
      enum:
      - 2
      - 3
- name: Audit events generated by other security policy changes that are not audited in the policy change category
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/PolicyChange_AuditOtherPolicyChangeEvents
        type: integer
        value: 2
    schema:
      enum:
      - 2
      - 3
- name: Audit events generated when a process is created or starts
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/DetailedTracking_AuditProcessCreation
        type: integer
        value: 1
    schema:
      const: 1
- name: Audit File Share
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/ObjectAccess_AuditFileShare
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Group Membership
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogonLogoff_AuditGroupMembership
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit insecure guest logon
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanServer
        value: AuditInsecureGuestLogon
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Audit IPsec Driver
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/System_AuditIPsecDriver
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Logoff
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogonLogoff_AuditLogoff
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit Logon
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogonLogoff_AuditLogon
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit MPSSVC Rule-Level Policy Change
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/PolicyChange_AuditMPSSVCRuleLevelPolicyChange
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Other Logon/Logoff Events
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogonLogoff_AuditOtherLogonLogoffEvents
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Other Object Access Events
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/ObjectAccess_AuditOtherObjectAccessEvents
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Other System Events
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/System_AuditOtherSystemEvents
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Policy Change
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/PolicyChange_AuditPolicyChange
        type: integer
        value: 3
    schema:
      enum:
      - 1
      - 3
- name: Audit Removable Storage
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/ObjectAccess_AuditRemovableStorage
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit Security Group Management
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountManagement_AuditSecurityGroupManagement
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit Security State Change
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/System_AuditSecurityStateChange
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit Security System Extension
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/System_AuditSecuritySystemExtension
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit Sensitive Privilege Use
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/PrivilegeUse_AuditSensitivePrivilegeUse
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit server does not support encryption
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanServer
        value: AuditServerDoesNotSupportEncryption
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Audit server does not support signing
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanServer
        value: AuditServerDoesNotSupportSigning
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Audit Special Logon
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountLogonLogoff_AuditSpecialLogon
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Audit System Integrity
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/System_AuditSystemIntegrity
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit the use of Backup and Restore privilege
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Audit_AuditTheUseOfBackupAndRestoreprivilege
        type: string
        value: MDA=
    schema:
      const: MDA=
- name: Audit User Account Management
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/AccountManagement_AuditUserAccountManagement
        type: integer
        value: 3
    schema:
      const: 3
- name: Audit when plug and play detects an external device
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Audit/DetailedTracking_AuditPNPActivity
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Audit_ForceAuditPolicySubcategorySettingsToOverrideAuditPolicyCategorySettings
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Audit: Shut down system immediately if unable to log security audits'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Audit_ShutdownSystemImmediatelyIfUnableToLogSecurityAudits
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Back up files and directories
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/BackupFilesAndDirectories
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Block abuse of exploited vulnerable signed drivers
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 56a863a9-875e-4185-98a7-b882c64b5ce5
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block Adobe Reader from creating child processes
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Block all consumer Microsoft account user authentication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\MicrosoftAccount
        value: DisableUserAuth
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block all Office applications from creating child processes
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: d4f940ab-401b-4efc-aadc-ad5f3c50688a
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Block credential stealing from the Windows local security authority subsystem (lsass.exe)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block executable content from email client and webmail
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: be9ba2d9-53ea-4cdc-84e5-9b1eeee46550
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Block executable files from running unless they meet a prevalence, age, or trusted list criterion
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 01443614-cd74-433a-b99e-2ecdc07bfc25
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block execution of potentially obfuscated scripts
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 5beb7efe-fd9a-4556-801d-275e5ffc04cc
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block JavaScript or VBScript from launching downloaded executable content
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: d3e037e1-3eb8-44c8-a917-57927947596d
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block NetBIOS-based discovery for domain controller location
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Netlogon\Parameters
        value: BlockNetbiosDiscovery
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block NTLM (LM NTLM NTLMv2)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation
        value: BlockNTLM
        type: REG_DWORD
        data: 0
    schema:
      minimum: 0
      maximum: 1
- name: Block NTLM Server Exception List
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation
        value: BlockNTLMServerExceptionList
        type: REG_SZ
        data: ""
    schema:
      oneOf:
      - maxItems: 0
      - const:
- name: Block Office applications from creating executable content
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 3b576869-a4ec-4529-8536-b80a7769e899
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Block Office applications from injecting code into other processes
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Block Office communication application from creating child processes
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 26190899-1602-49e8-8b27-eb1d0a1ce869
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Block persistence through WMI event subscription (File and folder exclusions not supported)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: e6db77e5-3df2-4cf1-b95a-636979351e5b
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: Block process creations originating from PSExec and WMI commands
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: d1e49aac-8f56-4280-b9ba-993a6d77406c
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: Block rebooting machine in Safe Mode (preview)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 33ddedf1-c6e0-47cb-833e-de6133960387
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: Block untrusted and unsigned processes that run from USB
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block use of copied or impersonated system tools (preview)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: c0033c00-d16d-4114-a5a0-dc9b3a7d2ceb
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: Block user from showing account details on sign-in
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: BlockUserFromShowingAccountDetailsOnSignin
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block Webshell creation for Servers
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: a8f5898e-1dc8-49a9-9878-85004b8a61e6
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Block Win32 API calls from Office macros
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: 92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Boot-Start Driver Initialization Policy
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Policies\EarlyLaunch
        value: DriverLoadPolicy
        type: REG_DWORD
        data: 3
    schema:
      oneOf:
      - const: 8
      - const: 1
      - const: 3
      - const:
- name: Bypass traverse checking
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/BypassTraverseChecking
        type: string
        value: '*S-1-5-32-544,*S-1-5-11,*S-1-5-32-551,*S-1-5-19,*S-1-5-20'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-11'
        - '*S-1-5-32-551'
        - '*S-1-5-19'
        - '*S-1-5-20'
- name: Change the system time
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ChangeSystemTime
        type: string
        value: '*S-1-5-32-544,*S-1-5-19'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-32-549'
        - '*S-1-5-19'
- name: Change the time zone
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ChangeTimeZone
        type: string
        value: '*S-1-5-32-544,*S-1-5-19'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-19'
- name: Configure Attack Surface Reduction rules
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR
        value: ExploitGuard_ASR_Rules
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure detection for potentially unwanted applications
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: PUAProtection
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: Configure enhanced anti-spoofing
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures
        value: EnhancedAntiSpoofing
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (KDC)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\KDC\Parameters
        value: PKINITHashAlgorithmConfigurationEnabled
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (KDC) - SHA1
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\KDC\Parameters
        value: PKINITSHA1
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (KDC) - SHA256
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\KDC\Parameters
        value: PKINITSHA256
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (KDC) - SHA384
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\KDC\Parameters
        value: PKINITSHA384
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (KDC) - SHA512
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\KDC\Parameters
        value: PKINITSHA512
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (Kerberos)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
        value: PKINITHashAlgorithmConfigurationEnabled
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (Kerberos) - SHA1
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
        value: PKINITSHA1
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (Kerberos) - SHA256
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
        value: PKINITSHA256
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (Kerberos) - SHA384
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
        value: PKINITSHA384
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure hash algorithms for certificate logon (Kerberos) - SHA512
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
        value: PKINITSHA512
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure local setting override for reporting to Microsoft MAPS
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\SpyNet
        value: LocalSettingOverrideSpynetReporting
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Configure NetBIOS settings
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient
        value: EnableNetbios
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Configure Offer Remote Assistance
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: fAllowUnsolicited
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Configure real-time protection and Security Intelligence Updates during OOBE
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
        value: OobeEnableRtpAndSigUpdate
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Configure registry policy processing: Do not apply during periodic background processing'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}
        value: NoBackgroundPolicy
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Configure registry policy processing: Process even if the Group Policy objects have not changed'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}
        value: NoGPOListChanges
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Configure SAM change password RPC methods policy
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\SAM
        value: SamrChangeUserPasswordApiPolicy
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure scheduled task times randomization window
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: SchedulerRandomizationTime
        type: REG_DWORD
        data: 4
    schema:
      minimum: 1
      maximum: 4
- name: Configure SMB v1 client driver
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\MrxSmb10
        value: Start
        type: REG_DWORD
        data: 4
    schema:
      const: 4
- name: Configure Solicited Remote Assistance
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: fAllowToGetHelp
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Configure the 'Block at First Sight' feature
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\SpyNet
        value: DisableBlockAtFirstSeen
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Configure Windows Defender SmartScreen
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: EnableSmartScreen
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Configure Windows Defender SmartScreen - Warn and Prevent bypass (Added)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: ShellSmartScreenLevel
        type: REG_SZ
        data: Block
    schema:
      const: Block
- name: Continue experiences on this device
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: EnableCdp
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Control whether exclusions are visible to local users
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: HideExclusionsFromLocalUsers
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Control whether or not exclusions are visible to Local Admins
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: HideExclusionsFromLocalAdmins
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Convert warn verdict to block
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\NIS
        value: EnableConvertWarnToBlock
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Create a pagefile
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/CreatePageFile
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Create a token object
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/CreateToken
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Create global objects
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/CreateGlobalObjects
        type: string
        value: '*S-1-5-32-544,*S-1-5-6,*S-1-5-19,*S-1-5-20'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-6'
        - '*S-1-5-19'
        - '*S-1-5-20'
- name: Create permanent shared objects
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/CreatePermanentSharedObjects
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Create symbolic links
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/CreateSymbolicLinks
        type: string
        value: '*S-1-5-32-544,*S-1-5-83-0'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-83-0'
- name: Debug programs
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/DebugPrograms
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: 'Delivery Optimization: Download Mode Methods'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization
        value: DODownloadMode
        type: REG_DWORD
        data: 2
    schema:
      enum:
      - 0
      - 1
      - 2
      - 99
      - 100
- name: Deny access to this computer from the network
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/DenyAccessFromNetwork
        type: string
        value: '*S-1-5-32-546'
    schema:
      allOf:
      - contains:
          const: '*S-1-5-32-546'
- name: Deny log on as a batch job
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/DenyLogOnAsBatchJob
        type: string
        value: '*S-1-5-32-546'
    schema:
      allOf:
      - contains:
          const: '*S-1-5-32-546'
- name: Deny log on as a service
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/DenyLogOnAsService
        type: string
        value: '*S-1-5-32-546'
    schema:
      allOf:
      - contains:
          const: '*S-1-5-32-546'
- name: Deny log on locally
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/DenyLocalLogOn
        type: string
        value: '*S-1-5-32-546'
    schema:
      allOf:
      - contains:
          const: '*S-1-5-32-546'
- name: Deny log on through Remote Desktop Services
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/DenyRemoteDesktopServicesLogOn
        type: string
        value: '*S-1-5-32-546'
    schema:
      allOf:
      - contains:
          const: '*S-1-5-32-546'
- name: Detect change from default RDP port
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp
        value: PortNumber
        type: REG_DWORD
        data: 3389
    schema:
      const: 3389
- name: 'Devices: Allowed to format and eject removable media'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Devices_AllowedToFormatAndEjectRemovableMedia
        type: string
        value: "0"
    schema:
      oneOf:
      - const: "0"
      - const: ""
- name: 'Devices: Prevent users from installing printer drivers'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Devices_PreventUsersFromInstallingPrinterDriversWhenConnectingToSharedPrinters
        type: integer
        value: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: Disable SMB v1 client (remove dependency on LanmanWorkstation)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation
        value: DependOnService
        type: REG_SZ
        data: Bowser,MRxSmb20,NSI
    schema:
      items:
        enum:
        - Bowser
        - MRxSmb20
        - NSI
- name: Disable SMB v1 server
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
        value: SMB1
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Disable Windows Search Service
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\Wsearch
        value: Start
        type: REG_DWORD
        data: 4
    schema:
      const: 4
- name: Disallow Autoplay for non-volume devices
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Explorer
        value: NoAutoplayfornonVolume
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not allow drive redirection
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: fDisableCdm
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not allow passwords to be saved
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: DisablePasswordSaving
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not delete temp folders upon exit
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: DeleteTempDirsOnExit
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not display network selection UI
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: DontDisplayNetworkSelectionUI
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not display the password reveal button
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\CredUI
        value: DisablePasswordReveal
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not enumerate connected users on domain-joined computers
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: DontEnumerateConnectedUsers
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not show feedback notifications
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection
        value: DoNotShowFeedbackNotifications
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Do not use temporary folders per session
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: PerSessionTempDir
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Domain member: Digitally encrypt or sign secure channel data (always)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/DomainMember_DigitallyEncryptOrSignSecureChannelDataAlways
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Domain member: Digitally encrypt secure channel data (when possible)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/DomainMember_DigitallyEncryptSecureChannelDataWhenPossible
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Domain member: Digitally sign secure channel data (when possible)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/DomainMember_DigitallySignSecureChannelDataWhenPossible
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Domain member: Disable machine account password changes'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/DomainMember_DisableMachineAccountPasswordChanges
        type: integer
        value: 0
    schema:
      const: 0
- name: 'Domain member: Maximum machine account password age'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/DomainMember_MaximumMachineAccountPasswordAge
        type: integer
        value: 30
    schema:
      const: 30
- name: 'Domain member: Require strong (Windows 2000 or later) session key'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/DomainMember_RequireStrongSessionKey
        type: integer
        value: 1
    schema:
      const: 1
- name: Enable authentication rate limiter
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanServer
        value: EnableAuthRateLimiter
        type: REG_DWORD
        data: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: Enable authentication rate limiter (Delay Timeout)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
        value: InvalidAuthenticationDelayTimeInMs
        type: REG_DWORD
        data: 2000
    schema:
      minimum: 2000
      maximum: 5000
- name: Enable computer and user accounts to be trusted for delegation
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/EnableDelegation
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Enable insecure guest logons
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LanmanWorkstation/EnableInsecureGuestLogons
        type: integer
        value: 0
    schema:
      const: 0
- name: Enable LSA PPL Protection
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
        value: RunAsPPL
        type: REG_DWORD
        data: 2
    schema:
      minimum: 1
      maximum: 2
- name: Enable remote mailslots (Lanman Server)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Browser
        value: EnableMailslots
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Enable remote mailslots (Lanman Workstation)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider
        value: EnableMailslots
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Enable RPC Endpoint Mapper Client Authentication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Rpc
        value: EnableAuthEpResolution
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Enable Structured Exception Handling Overwrite Protection (SEHOP)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel
        value: DisableExceptionChainValidation
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Enable Windows NTP Client
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient
        value: Enabled
        type: REG_DWORD
        data:
    schema:
- name: Encryption Oracle Remediation for CredSSP protocol
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters
        value: AllowEncryptionOracle
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Enforce password history
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/PasswordHistorySize
        type: integer
        value: 24
    schema:
      const: 24
- name: Enumerate administrator accounts on elevation
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI
        value: EnumerateAdministrators
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Enumerate local users on domain-joined computers
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: EnumerateLocalUsers
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Enumeration policy for external devices incompatible with Kernel DMA Protection
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DmaGuard/DeviceEnumerationPolicy
        type: integer
        value: 0
    schema:
      enum:
      - 0
      - 1
- name: Force shutdown from a remote system
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/RemoteShutdown
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Generate security audits
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/GenerateSecurityAudits
        type: string
        value: '*S-1-5-19,*S-1-5-20,*S-1-5-82-3006700770-424185619-1745488364-794895919-4004696415'
    schema:
      items:
        enum:
        - '*S-1-5-19'
        - '*S-1-5-20'
        - '*S-1-5-82-3006700770-424185619-1745488364-794895919-4004696415'
- name: Hardened UNC Paths - NETLOGON
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths
        value: '\\*\NETLOGON'
        type: REG_SZ
        data: RequireMutualAuthentication=1,RequireIntegrity=1
    schema:
      allOf:
      - contains:
          const: RequireMutualAuthentication=1
      - contains:
          const: RequireIntegrity=1
- name: Hardened UNC Paths - SYSVOL
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths
        value: '\\*\SYSVOL'
        type: REG_SZ
        data: RequireMutualAuthentication=1,RequireIntegrity=1
    schema:
      allOf:
      - contains:
          const: RequireMutualAuthentication=1
      - contains:
          const: RequireIntegrity=1
- name: Impersonate a client after authentication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ImpersonateClient
        type: string
        value: '*S-1-5-32-544,*S-1-5-6,*S-1-5-19,*S-1-5-20'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-6'
        - '*S-1-5-19'
        - '*S-1-5-20'
- name: Include command line in process creation events
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit
        value: ProcessCreationIncludeCmdLine_Enabled
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Increase a process working set
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/IncreaseProcessWorkingSet
        type: string
        value: '*S-1-5-32-544,*S-1-5-19'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-19'
- name: Increase scheduling priority
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/IncreaseSchedulingPriority
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-90-0'
- name: 'Interactive logon: Do not display last user name'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/InteractiveLogon_DoNotDisplayLastSignedIn
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Interactive logon: Do not require CTRL+ALT+DEL'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/InteractiveLogon_DoNotRequireCTRLALTDEL
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: 'Interactive logon: Machine inactivity limit'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/InteractiveLogon_MachineInactivityLimit
        type: integer
        value: 900
    schema:
      minimum: 1
      maximum: 900
- name: 'Interactive logon: Message text for users attempting to log on'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: LegalNoticeText
        type: REG_SZ
        data:
    schema:
      not:
        oneOf:
        - const: ""
        - const:
- name: 'Interactive logon: Message title for users attempting to log on'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: LegalNoticeCaption
        type: REG_SZ
        data:
    schema:
      not:
        oneOf:
        - const: ""
        - const:
- name: 'Interactive Logon: Number of previous logons to cache (in case Domain Controller is not available)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
        value: CachedLogonsCount
        type: REG_SZ
        data: "4"
    schema:
      minimum: 0
      maximum: 4
- name: 'Interactive logon: Prompt user to change password before expiration'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/InteractiveLogon_PromptUserToChangePasswordBeforeExpiration
        type: integer
        value: 14
    schema:
      minimum: 5
      maximum: 14
- name: 'Interactive logon: Smart card removal behavior'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/InteractiveLogon_SmartCardRemovalBehavior
        type: string
        value: "1"
    schema:
      const: 1
- name: Join Microsoft MAPS
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\SpyNet
        value: SpynetReporting
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: Limits print driver installation to Administrators
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint
        value: RestrictDriverInstallationToAdministrators
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Load and unload device drivers
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/LoadUnloadDeviceDrivers
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
- name: Lock pages in memory
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/LockMemory
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Manage auditing and security log
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ManageAuditingAndSecurityLog
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Mandate the minimum version of SMB Client
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation
        value: MinSmb2Dialect
        type: REG_DWORD
        data: 768
    schema:
      enum:
      - 768
      - 770
      - 785
- name: Mandate the minimum version of SMB Server
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanServer
        value: MinSmb2Dialect
        type: REG_DWORD
        data: 768
    schema:
      enum:
      - 768
      - 770
      - 785
- name: Maximum password age
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/MaximumPasswordAge
        type: integer
        value: 42
    schema:
      minimum: 1
      maximum: 60
- name: 'Microsoft network client: Digitally sign communications (always)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkClient_DigitallySignCommunicationsAlways
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Microsoft network client: Digitally sign communications (if server agrees)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkClient_DigitallySignCommunicationsIfServerAgrees
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Microsoft network client: Send unencrypted password to third-party SMB servers'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkClient_SendUnencryptedPasswordToThirdPartySMBServers
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: 'Microsoft network server: Amount of idle time required before suspending session'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkServer_AmountOfIdleTimeRequiredBeforeSuspendingSession
        type: integer
        value: 15
    schema:
      minimum: 1
      maximum: 15
- name: 'Microsoft network server: Digitally sign communications (always)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkServer_DigitallySignCommunicationsAlways
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Microsoft network server: Digitally sign communications (if client agrees)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkServer_DigitallySignCommunicationsIfClientAgrees
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Microsoft network server: Disconnect clients when logon hours expire'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkServer_DisconnectClientsWhenLogonHoursExpire
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Microsoft network server: Server SPN target name validation level'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/MicrosoftNetworkServer_ServerSPNTargetNameValidationLevel
        type: integer
        value: 1
    schema:
      const: 1
- name: Minimize the number of simultaneous connections to the Internet or a Windows Domain
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy
        value: fMinimizeConnections
        type: REG_DWORD
        data: 3
    schema:
      const: 3
- name: Minimum password age
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/MinimumPasswordAge
        type: integer
        value: 1
    schema:
      minimum: 1
- name: Minimum password length
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/MinDevicePasswordLength
        type: integer
        value: 14
    schema:
      minimum: 14
- name: Modify an object label
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ModifyObjectLabel
        type: string
        value: ""
    schema:
      maxItems: 0
- name: Modify firmware environment values
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ModifyFirmwareEnvironment
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters
        value: DisableIPSourceRouting
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: 'MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
        value: DisableIPSourceRouting
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
        value: EnableICMPRedirect
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\NetBT\Parameters
        value: NoNameReleaseOnDemand
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager
        value: SafeDllSearchMode
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Security
        value: WarningLevel
        type: REG_DWORD
        data: 90
    schema:
      minimum: 50
      maximum: 90
- name: NetBT NodeType configuration
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\NetBT\Parameters
        value: NodeType
        type: REG_DWORD
        data: 2
    schema:
      const: 2
- name: 'Network access: Allow anonymous SID/Name translation'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_AllowAnonymousSIDOrNameTranslation
        type: integer
        value: 0
    schema:
      const: 0
- name: 'Network access: Do not allow anonymous enumeration of SAM accounts'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_DoNotAllowAnonymousEnumerationOfSAMAccounts
        type: integer
        value: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: 'Network access: Do not allow anonymous enumeration of SAM accounts and shares'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_DoNotAllowAnonymousEnumerationOfSamAccountsAndShares
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Network access: Let Everyone permissions apply to anonymous users'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_LetEveryonePermissionsApplyToAnonymousUsers
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: 'Network access: Remotely accessible registry paths'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_RemotelyAccessibleRegistryPaths
        type: string
        value: System\CurrentControlSet\Control\ProductOptions,System\CurrentControlSet\Control\Server Applications,Software\Microsoft\Windows NT\CurrentVersion
    schema:
      oneOf:
      - items:
          enum:
          - System\CurrentControlSet\Control\ProductOptions
          - System\CurrentControlSet\Control\Server Applications
          - Software\Microsoft\Windows NT\CurrentVersion
        minItems: 3
        maxItems: 3
        uniqueItems: true
      - maxItems: 0
- name: 'Network access: Remotely accessible registry paths and sub-paths'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_RemotelyAccessibleRegistryPathsAndSubpaths
        type: string
        value: System\CurrentControlSet\Control\Print\Printers,System\CurrentControlSet\Services\Eventlog,Software\Microsoft\OLAP Server,Software\Microsoft\Windows NT\CurrentVersion\Print,Software\Microsoft\Windows NT\CurrentVersion\Windows,System\CurrentControlSet\Control\ContentIndex,System\CurrentControlSet\Control\Terminal Server,System\CurrentControlSet\Control\Terminal Server\UserConfig,System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration,Software\Microsoft\Windows NT\CurrentVersion\Perflib,System\CurrentControlSet\Services\SysmonLog
    schema:
      oneOf:
      - items:
          enum:
          - System\CurrentControlSet\Control\Print\Printers
          - System\CurrentControlSet\Services\Eventlog
          - Software\Microsoft\OLAP Server
          - Software\Microsoft\Windows NT\CurrentVersion\Print
          - Software\Microsoft\Windows NT\CurrentVersion\Windows
          - System\CurrentControlSet\Control\ContentIndex
          - System\CurrentControlSet\Control\Terminal Server
          - System\CurrentControlSet\Control\Terminal Server\UserConfig
          - System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration
          - Software\Microsoft\Windows NT\CurrentVersion\Perflib
          - System\CurrentControlSet\Services\SysmonLog
        minItems: 11
        maxItems: 11
        uniqueItems: true
      - maxItems: 0
- name: 'Network access: Restrict anonymous access to Named Pipes and Shares'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_RestrictAnonymousAccessToNamedPipesAndShares
        type: integer
        value: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: 'Network access: Restrict clients allowed to make remote calls to SAM'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_RestrictClientsAllowedToMakeRemoteCallsToSAM
        type: string
        value: O:BAG:BAD:(A;;RC;;;BA)
    schema:
      oneOf:
      - const: O:BAG:BAD:(A;;RC;;;BA)
      - const: ""
- name: 'Network access: Shares that can be accessed anonymously'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_SharesThatCanBeAccessedAnonymously
        type: string
        value: ""
    schema:
      oneOf:
      - maxItems: 0
      - const:
- name: 'Network access: Sharing and security model for local accounts'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkAccess_SharingAndSecurityModelForLocalAccounts
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: 'Network security: Allow Local System to use computer identity for NTLM'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_AllowLocalSystemToUseComputerIdentityForNTLM
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Network security: Allow LocalSystem NULL session fallback'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_AllowLocalSystemNULLSessionFallback
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: 'Network Security: Allow PKU2U authentication requests to this computer to use online identities'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\pku2u
        value: AllowOnlineID
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Network Security: Configure encryption types allowed for Kerberos'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
        value: SupportedEncryptionTypes
        type: REG_DWORD
        data: 2147483640
    schema:
      enum:
      - 2147483624
      - 2147483632
      - 2147483640
- name: 'Network security: Force logoff when logon hours expire'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_ForceLogoffWhenLogonHoursExpire
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Network security: LAN Manager authentication level'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_LANManagerAuthenticationLevel
        type: integer
        value: 5
    schema:
      const: 5
- name: 'Network security: LDAP client signing requirements'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_LDAPClientSigningRequirements
        type: integer
        value: 1
    schema:
      minimum: 1
      maximum: 2
- name: 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_MinimumSessionSecurityForNTLMSSPBasedClients
        type: integer
        value: 537395200
    schema:
      const: 537395200
- name: 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/NetworkSecurity_MinimumSessionSecurityForNTLMSSPBasedServers
        type: integer
        value: 537395200
    schema:
      const: 537395200
- name: Override Minimum Enabled DTLS Version Client
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Cryptography/OverrideMinimumEnabledDTLSVersionClient
        type: string
        value: "1.2"
    schema:
      const: "1.2"
- name: Override Minimum Enabled DTLS Version Server
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Cryptography/OverrideMinimumEnabledDTLSVersionServer
        type: string
        value: "1.2"
    schema:
      const: "1.2"
- name: Override Minimum Enabled TLS Version Client
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Cryptography/OverrideMinimumEnabledTLSVersionClient
        type: string
        value: "1.2"
    schema:
      oneOf:
      - const: "1.2"
      - const: "1.3"
- name: Override Minimum Enabled TLS Version Server
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Cryptography/OverrideMinimumEnabledTLSVersionServer
        type: string
        value: "1.2"
    schema:
      oneOf:
      - const: "1.2"
      - const: "1.3"
- name: Password must meet complexity requirements
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/PasswordComplexity
        type: integer
        value: 1
    schema:
      const: 1
- name: Perform volume maintenance tasks
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ManageVolume
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Prevent device metadata retrieval from the Internet
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Device Metadata
        value: PreventDeviceMetadataFromNetwork
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Prevent downloading of enclosures
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds
        value: DisableEnclosureDownload
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Prevent enabling lock screen camera
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization
        value: NoLockScreenCamera
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Prevent enabling lock screen slide show
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization
        value: NoLockScreenSlideshow
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Prevent users from modifying settings
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection
        value: DisallowExploitProtectionOverride
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Profile single process
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ProfileSingleProcess
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Profile system performance
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ProfileSystemPerformance
        type: string
        value: '*S-1-5-32-544,*S-1-5-80-3139157870-2983391045-3678747466-658725712-1809340420'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
        - '*S-1-5-80-3139157870-2983391045-3678747466-658725712-1809340420'
- name: Prohibit installation and configuration of Network Bridge on your DNS domain network
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections
        value: NC_AllowNetBridge_NLA
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Prohibit use of Internet Connection Sharing on your DNS domain network
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections
        value: NC_ShowSharedAccessUI
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Recovery console: Allow floppy copy and access to all drives and all folders'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/RecoveryConsole_AllowFloppyCopyAndAccessToAllDrivesAndAllFolders
        type: integer
        value: 0
    schema:
      const: 0
- name: Remote host allows delegation of non-exportable credentials
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation
        value: AllowProtectedCreds
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Remote management (WinRM) Allow Basic authentication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client
        value: AllowBasic
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Remote management (WinRM) Allow Basic authentication - Service
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
        value: AllowBasic
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Remote management (WinRM) Allow unencrypted traffic
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client
        value: AllowUnencryptedTraffic
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Remote management (WinRM) Allow unencrypted traffic - Service
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
        value: AllowUnencryptedTraffic
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Remote management (WinRM) Disallow Digest authentication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client
        value: AllowDigest
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Remote management (WinRM) Disallow WinRM from storing RunAs credentials
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
        value: DisableRunAs
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Replace a process level token
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ReplaceProcessLevelToken
        type: string
        value: '*S-1-5-19,*S-1-5-20'
    schema:
      items:
        enum:
        - '*S-1-5-19'
        - '*S-1-5-20'
- name: Require Encryption
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation
        value: RequireEncryption
        type: REG_DWORD
        data: 0
    schema:
      minimum: 0
      maximum: 1
- name: Require secure RPC communication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: fEncryptRPCTraffic
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Require user authentication for remote connections by using Network Level Authentication
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: UserAuthentication
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Restore files and directories
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/RestoreFilesAndDirectories
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: Restrict Unauthenticated RPC clients
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Rpc
        value: RestrictRemoteClients
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Scan all downloaded files and attachments
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
        value: DisableIOAVProtection
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Scan excluded files and directories during quick scans
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Scan
        value: QuickScanIncludeExclusions
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Scan removable drives
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Scan
        value: DisableRemovableDriveScanning
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Secured-Core Hypervisor-protected Code Integrity (HVCI)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/VirtualizationBasedTechnology/HypervisorEnforcedCodeIntegrity
        type: integer
        value: 2
    schema:
      minimum: 1
      maximum: 2
- name: Secured-Core Require MicrosoftSignedBootChain
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard
        value: RequireMicrosoftSignedBootChain
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Secured-Core Require Platform Security (Secure Boot, DMA)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceGuard/RequirePlatformSecurityFeatures
        type: integer
        value: 1
    schema:
      enum:
      - 1
      - 3
- name: Secured-Core Require UEFI Memory Attribute Table
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard
        value: HVCIMATRequired
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Secured-Core SystemGuard (DRTM)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceGuard/ConfigureSystemGuardLaunch
        type: integer
        value: 1
    schema:
      const: 1
- name: Secured-Core Virtualization Based Security (VBS)
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceGuard/EnableVirtualizationBasedSecurity
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Security: Control Event Log behavior when the log file reaches its maximum size'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security
        value: Retention
        type: REG_SZ
        data: "0"
    schema:
      oneOf:
      - const: "0"
      - const:
- name: 'Security: Specify the maximum log file size (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security
        value: MaxSize
        type: REG_DWORD
        data: 196608
    schema:
      minimum: 196608
- name: Select cloud protection level
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\MpEngine
        value: MpCloudBlockLevel
        type: REG_DWORD
        data: 2
    schema:
      enum:
      - 2
      - 4
      - 6
- name: Select the channel for Microsoft Defender daily security intelligence updates
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: SignaturesRing
        type: REG_DWORD
        data: 5
    schema:
      const: 5
- name: Select the channel for Microsoft Defender monthly engine updates
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: EngineRing
        type: REG_DWORD
        data: 5
    schema:
      enum:
      - 5
      - 6
- name: Select the channel for Microsoft Defender monthly platform updates
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: PlatformRing
        type: REG_DWORD
        data: 5
    schema:
      enum:
      - 5
      - 6
- name: Send file samples when further analysis is required
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\SpyNet
        value: SubmitSamplesConsent
        type: REG_DWORD
        data: 1
    schema:
      enum:
      - 1
      - 3
- name: Set client connection encryption level
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
        value: MinEncryptionLevel
        type: REG_DWORD
        data: 3
    schema:
      minimum: 3
      maximum: 4
- name: Set the default behavior for AutoRun
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
        value: NoAutorun
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Setup: Control Event Log behavior when the log file reaches its maximum size'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup
        value: Retention
        type: REG_SZ
        data: "0"
    schema:
      oneOf:
      - const: "0"
      - const:
- name: 'Setup: Specify the maximum log file size (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup
        value: MaxSize
        type: REG_DWORD
        data: 32768
    schema:
      minimum: 32768
- name: Shut down the system
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/ShutDownTheSystem
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: 'Shutdown: Allow system to be shut down without having to log on'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Shutdown_AllowSystemToBeShutDownWithoutHavingToLogOn
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: 'Shutdown: Clear virtual memory pagefile'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Shutdown_ClearVirtualMemoryPageFile
        type: integer
        value: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Sign-in and lock last interactive user automatically after a restart
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: AutomaticRestartSignOnConfig
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Sign-in last interactive user automatically after a system-initiated restart
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: DisableAutomaticRestartSignOn
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: SSL Cryptography Cipher suites
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002
        value: Functions
        type: REG_SZ
        data: TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
    schema:
      items:
        enum:
        - TLS_AES_128_GCM_SHA256
        - TLS_AES_256_GCM_SHA384
        - TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
        - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
        - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
        - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        - TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
        - TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
        - TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
        - TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
- name: SSL Cryptography EccCurves
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002
        value: EccCurves
        type: REG_SZ
        data: NistP256,NistP384
    schema:
      items:
        enum:
        - NistP256
        - NistP384
- name: Store passwords using reversible encryption
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/DeviceLock/ClearTextPassword
        type: integer
        value: 0
    schema:
      const: 0
- name: 'System Cryptography: Force strong key protection for user keys stored on the computer'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Cryptography/ConfigureSystemCryptographyForceStrongKeyProtection
        type: integer
        value: 2
    schema:
      const: 2
- name: 'System objects: Require case insensitivity for non-Windows subsystems'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/SystemObjects_RequireCaseInsensitivityForNonWindowsSubsystems
        type: integer
        value: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: 'System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/SystemObjects_StrengthenDefaultPermissionsOfInternalSystemObjects
        type: integer
        value: 1
    schema:
      const: 1
- name: System Policies NtfsEncryptPagingFile
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Policies
        value: NtfsEncryptPagingFile
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: System Services Afd DisableAddressSharing
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Services\Afd\Parameters
        value: DisableAddressSharing
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Safer\CodeIdentifiers
        value: AuthenticodeEnabled
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'System: Control Event Log behavior when the log file reaches its maximum size'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\System
        value: Retention
        type: REG_SZ
        data: "0"
    schema:
      oneOf:
      - const: "0"
      - const:
- name: 'System: Specify the maximum log file size (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\System
        value: MaxSize
        type: REG_DWORD
        data: 32768
    schema:
      minimum: 32768
- name: Take ownership of files or other objects
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/UserRights/TakeOwnership
        type: string
        value: '*S-1-5-32-544'
    schema:
      items:
        enum:
        - '*S-1-5-32-544'
      unevaluatedItems: false
- name: This setting controls datagram processing for Network Protection is enabled on Server
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\NIS\Consumers\IPS
        value: AllowDatagramProcessingOnWinServer
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: This setting controls whether Network Protection is allows to be configured into block or Audit mode on Windows Server
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection
        value: AllowNetworkProtectionOnWinServer
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn off app notifications on the lock screen
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: DisableLockScreenAppNotifications
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn off Auto Exclusions
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Exclusions
        value: DisableAutoExclusions
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn off Autoplay
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
        value: NoDriveTypeAutoRun
        type: REG_DWORD
        data: 255
    schema:
      const: 255
- name: Turn off background refresh of Group Policy
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
        value: DisableBkGndGroupPolicy
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn off cloud consumer account state content
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Experience/DisableConsumerAccountStateContent
        type: integer
        value: 1
    schema:
      const: 1
- name: Turn off Data Execution Prevention for Explorer
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Explorer
        value: NoDataExecutionPrevention
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Turn off downloading of print drivers over HTTP
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers
        value: DisableWebPnPDownload
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn off heap termination on corruption
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Explorer
        value: NoHeapTerminationOnCorruption
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Internet Connection Wizard
        value: ExitOnMSICW
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn off Inventory Collector
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\AppCompat
        value: DisableInventory
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn off Microsoft consumer experiences
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/Experience/AllowWindowsConsumerFeatures
        type: integer
        value: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: Turn off Microsoft Defender AntiVirus
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: DisableAntiSpyware
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn off multicast name resolution
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient
        value: EnableMulticast
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn off printing over HTTP
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers
        value: DisableHTTPPrinting
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn off real-time protection
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
        value: DisableRealtimeMonitoring
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn off routine remediation
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
        value: DisableRoutinelyTakingAction
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn off shell protocol protected mode
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
        value: PreXPSP2ShellProtocolBehavior
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Turn on behavior monitoring
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
        value: DisableBehaviorMonitoring
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn on convenience PIN sign-in
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
        value: AllowDomainPINLogon
        type: REG_DWORD
        data: 0
    schema:
      oneOf:
      - const: 0
      - const:
- name: Turn on CredentialGuard
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
        value: LsaCfgFlags
        type: REG_DWORD
        data: 2
    schema:
      minimum: 1
      maximum: 2
- name: Turn on e-mail scanning
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Scan
        value: DisableEmailScanning
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn on PowerShell Script Block Logging
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
        value: EnableScriptBlockLogging
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: Turn on PowerShell Transcription
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription
        value: EnableTranscripting
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn on scan after security intelligence update
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Signature Updates
        value: DisableScanOnUpdate
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn on script scanning
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
        value: DisableScriptScanning
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: Turn On Virtualization Based Security | KernelShadowStackLaunch
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard
        value: ConfigureKernelShadowStacksLaunch
        type: REG_DWORD
        data: 2
    schema:
      minimum: 1
      maximum: 2
- name: Use advanced protection against ransomware
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
        value: c1db55ab-c21a-4637-bb3f-a12568109d35
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'User Account Control: Admin Approval Mode for the Built-in Administrator account'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_UseAdminApprovalMode
        type: integer
        value: 1
    schema:
      const: 1
- name: 'User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_AllowUIAccessApplicationsToPromptForElevation
        type: integer
        value: 0
    schema:
      const: 0
- name: 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_BehaviorOfTheElevationPromptForAdministrators
        type: integer
        value: 2
    schema:
      minimum: 1
      maximum: 2
- name: 'User Account Control: Behavior of the elevation prompt for standard users'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_BehaviorOfTheElevationPromptForStandardUsers
        type: integer
        value: 0
    schema:
      const: 0
- name: 'User Account Control: Detect application installations and prompt for elevation'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_DetectApplicationInstallationsAndPromptForElevation
        type: integer
        value: 1
    schema:
      const: 1
- name: 'User Account Control: Only elevate UIAccess applications that are installed in secure locations'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_OnlyElevateUIAccessApplicationsThatAreInstalledInSecureLocations
        type: integer
        value: 1
    schema:
      const: 1
- name: 'User Account Control: Run all administrators in Admin Approval Mode'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_RunAllAdministratorsInAdminApprovalMode
        type: integer
        value: 1
    schema:
      const: 1
- name: 'User Account Control: Switch to the secure desktop when prompting for elevation'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_SwitchToTheSecureDesktopWhenPromptingForElevation
        type: integer
        value: 1
    schema:
      const: 1
- name: 'User Account Control: Virtualize file and registry write failures to per-user locations'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/CSP
      properties:
        path: ./Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_VirtualizeFileAndRegistryWriteFailuresToPerUserLocations
        type: integer
        value: 1
    schema:
      const: 1
- name: 'Windows Firewall: Domain: Allow unicast response'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: DisableUnicastResponsesToMulticastBroadcast
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Windows Firewall: Domain: Firewall state'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: EnableFirewall
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Domain: Inbound connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: DefaultInboundAction
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Domain: Logging: Log dropped packets'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
        value: LogDroppedPackets
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Domain: Logging: Log successful connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
        value: LogSuccessfulConnections
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Domain: Logging: Name'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
        value: LogFilePath
        type: REG_SZ
        data: '%SystemRoot%\System32\logfiles\firewall\domainfw.log'
    schema:
      pattern: .log
- name: 'Windows Firewall: Domain: Logging: Size limit (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
        value: LogFileSize
        type: REG_DWORD
        data: 16384
    schema:
      minimum: 16384
- name: 'Windows Firewall: Domain: Outbound connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: DefaultOutboundAction
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Windows Firewall: Domain: Settings: Apply local connection security rules'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: AllowLocalIPsecPolicyMerge
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Domain: Settings: Apply local firewall rules'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: AllowLocalPolicyMerge
        type: REG_DWORD
        data: 1
    schema:
      oneOf:
      - const: 1
      - const:
- name: 'Windows Firewall: Domain: Settings: Display a notification'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
        value: DisableNotifications
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Allow unicast response'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: DisableUnicastResponsesToMulticastBroadcast
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Windows Firewall: Private: Firewall state'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: EnableFirewall
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Inbound connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: DefaultInboundAction
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Logging: Log dropped packets'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
        value: LogDroppedPackets
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Logging: Log successful connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
        value: LogSuccessfulConnections
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Logging: Name'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
        value: LogFilePath
        type: REG_SZ
        data: '%SystemRoot%\System32\logfiles\firewall\privatefw.log'
    schema:
      pattern: .log
- name: 'Windows Firewall: Private: Logging: Size limit (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
        value: LogFileSize
        type: REG_DWORD
        data: 16384
    schema:
      minimum: 16384
- name: 'Windows Firewall: Private: Outbound connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: DefaultOutboundAction
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Windows Firewall: Private: Settings: Apply local connection security rules'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: AllowLocalIPsecPolicyMerge
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Settings: Apply local firewall rules'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: AllowLocalPolicyMerge
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Private: Settings: Display a notification'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
        value: DisableNotifications
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Allow unicast response'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: DisableUnicastResponsesToMulticastBroadcast
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Firewall state'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: EnableFirewall
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Inbound connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: DefaultInboundAction
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Logging: Log dropped packets'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
        value: LogDroppedPackets
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Logging: Log successful connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
        value: LogSuccessfulConnections
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Logging: Name'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
        value: LogFilePath
        type: REG_SZ
        data: '%SystemRoot%\System32\logfiles\firewall\publicfw.log'
    schema:
      pattern: .log
- name: 'Windows Firewall: Public: Logging: Size limit (KB)'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
        value: LogFileSize
        type: REG_DWORD
        data: 16384
    schema:
      minimum: 16384
- name: 'Windows Firewall: Public: Outbound connections'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: DefaultOutboundAction
        type: REG_DWORD
        data: 0
    schema:
      const: 0
- name: 'Windows Firewall: Public: Settings: Apply local connection security rules'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: AllowLocalIPsecPolicyMerge
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Settings: Apply local firewall rules'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: AllowLocalPolicyMerge
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: 'Windows Firewall: Public: Settings: Display a notification'
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
        value: DisableNotifications
        type: REG_DWORD
        data: 1
    schema:
      const: 1
- name: WindowsNT MitigationOptions MitigationOptions FontBocking
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\MitigationOptions
        value: MitigationOptions_FontBocking
        type: REG_SZ
        data: "1000000000000"
    schema:
      const: "1000000000000"
- name: WinVerifyTrust Signature Validation vulnerability Mitigation 1
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Microsoft\Cryptography\Wintrust\Config
        value: EnableCertPaddingCheck
        type: REG_SZ
        data: "1"
    schema:
      const: 1
- name: WinVerifyTrust Signature Validation vulnerability Mitigation 2
  type: Microsoft.OSConfig/Test
  properties:
    resource:
      type: Microsoft.Windows/Registry
      properties:
        key: HKLM:\SOFTWARE\Wow6432Node\Microsoft\Cryptography\Wintrust\Config
        value: EnableCertPaddingCheck
        type: REG_SZ
        data: "1"
    schema:
      const: 1

